# 🛡️ THE FOCUS ENFORCER v1.0 - 專注執法者

## 📖 專案簡介
**THE FOCUS ENFORCER** 是一個結合硬體監控與社交懲罰機制的「零信任」專注力強化系統。不同於一般的專注 App 只能在軟體層面提醒，本系統透過實體硬體盒子與多重感測器，強制使用者將手機鎖定或保持在特定區域。

一旦系統偵測到使用者在專注期間違規（如：提前取出手機、離開座位、打開盒蓋），系統將會立即執行「社交羞辱協定 (Social Shame Protocol)」，將使用者預先上傳的「人質照片」發布至社交平台 (Threads) 或傳送給指定聯絡人。

---

## 🚀 核心功能

### 1. 零信任硬體監控 (Zero-Trust Monitoring)
系統採用嚴格的硬體狀態機架構，確保監控的準確性與不可繞過性。

- **狀態機架構**: 6 種硬體狀態 (IDLE → PREPARING → FOCUSING → PAUSED → VIOLATION → ERROR)
- **10 秒準備寬限期**: 開始專注前有 10 秒緩衝時間 (PREPARING)，讓使用者安置手機與調整環境。
- **多重感測融合**: 
    - **KY-033 紅外線感測器**: 用於偵測盒蓋開關狀態 (Box Open/Closed)。
        - *註：後端邏輯中對應 `box_open` 或 `hall_detected` 欄位。*
    - **毫米波雷達 (LD2410)**: 精確偵測使用者是否在座位上 (Presence Detection)。
    - **MAX9418 聲音感測器**: 監測環境噪音 (Noise Detection)，防止在安靜場所發出噪音。
    - **PN532 NFC 模組**: 偵測手機是否已放入盒子中 (Phone Detection)，確保「物理鎖定」。
- **1602 LCD 顯示**: 本地即時顯示當前狀態、倒數計時與違規資訊。

### 2. 彈性專注控制
- **暫停/繼續功能**: 支援暫時停止監測 (PAUSED)，不觸發懲罰，適用於短暫休息或緊急狀況。
- **即時同步**: 前端儀表板與硬體狀態透過 WebSocket 毫秒級同步。

### 3. 社交羞辱協定 (Social Shame Protocol)
這是本系統最強大的約束力來源。

- **人質系統 (Hostage System)**: 
    - 使用者需先上傳「人質照片」（如：尷尬的自拍、黑歷史照片）。
    - 支援拖曳上傳，最多 30 張。
    - 違規時隨機挑選一張進行「處決」。
- **自動化懲罰**: 
    - **Threads**: 自動發文並附上人質照片。
    - **Gmail**: 發送羞辱郵件給指定聯絡人 (如親友、老闆)。
- **懲罰設定**: 可自訂觸發條件 (如：是否啟用噪音懲罰、是否啟用離座懲罰)。

### 4. 現代化儀表板 (Dashboard)
- **即時數據**: 視覺化顯示所有感測器數值 (雷達、光感、噪音)。
- **懲罰進度**: 違規時顯示紅色警示與懲罰執行進度條。
- **模擬模式 (Mock Mode)**: 內建軟體模擬器，無需連接實體硬體即可測試所有功能。

### 5. 專注歷史與統計 (Session History)
- **歷史紀錄**: 自動保存每次專注的起始時間、持續長度與違規次數。
- **數據統計**: 計算完賽率、總專注時間等關鍵指標，幫助使用者追蹤進步。

### 6. 嚴格零容忍懲罰 (Strict Zero-Tolerance)
- **立即裁決**: 一旦偵測到違規 (如手機移除、離開座位逾時)，系統將**立即**執行懲罰並強制結束專注 Session。
- **每日違規追蹤**: 記錄「今日累積違規次數」，所有違規行為都會被永久記錄。
- **遞進式傳播 (Progressive Consequences)**: 雖然違規是立即判定，但懲罰的社交傳播範圍可依據違規次數擴大 (例如：第 1 次僅 Discord 通知，第 2 次發送 Gmail 給老闆)。

---

## 🛠️ 技術架構

### 後端 (Backend)
- **FastAPI**: 高性能 Python Web 框架，提供 REST API 與 WebSocket 服務。
- **Socket.IO**: 實現即時雙向通訊，連接前端與硬體。
- **Playwright**: 用於瀏覽器自動化，執行 Threads 發文操作。
- **Pydantic**: 嚴格的資料模型驗證與設定管理。
- **Credential Store**: 加密憑證儲存，保障社交帳號安全。

### 前端 (Frontend)
- **React 18 + TypeScript**: 現代化前端框架。
- **Vite**: 極速建置工具。
- **Tailwind CSS**: 實用優先的 CSS 框架，打造精美 Cyberpunk 風格 UI。
- **Shadcn/ui**: 高品質 UI 元件庫。
- **多語言支援**: 完整支援繁體中文 (zh-TW) 與英文 (en) 介面切換。

### 硬體 (Hardware)
- **PlatformIO (C++)**: 韌體開發環境。
- **ESP8266 (Wemos D1 Mini)**: 主控晶片。
- **狀態機設計**: 韌體層級實作狀態機，確保邏輯穩健。
